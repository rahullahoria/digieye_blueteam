(function(e){e.fn.styler=function(t){var n=e.extend({wrapper:"form",idSuffix:"-styler",filePlaceholder:"The file is not selected.",fileBrowse:"Select the file",selectPlaceholder:"Select...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"No matches found",selectSearchPlaceholder:"Search...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}},t);return this.each(function(){function t(){var e="",t="",i="",s="";void 0!==r.attr("id")&&""!==r.attr("id")&&(e=' id="'+r.attr("id")+n.idSuffix+'"');void 0!==r.attr("title")&&""!==r.attr("title")&&(t=' title="'+r.attr("title")+'"');void 0!==r.attr("class")&&""!==r.attr("class")&&(i=" "+r.attr("class"));var o=r.data(),u;for(u in o)""!==o[u]&&(s+=" data-"+u+'="'+o[u]+'"');this.id=e+s;this.title=t;this.classes=i}var r=e(this);if(r.is(":checkbox"))r.each(function(){if(1>r.parent("div.jq-checkbox").length){var n=function(){var n=new t,i=e("<div"+n.id+' class="jq-checkbox'+n.classes+'"'+n.title+'><div class="jq-checkbox__div"></div></div>');r.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(i).prependTo(i);i.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});r.is(":checked")&&i.addClass("checked");r.is(":disabled")&&i.addClass("disabled");i.on("click.styler",function(){i.is(".disabled")||(r.is(":checked")?(r.prop("checked",!1),i.removeClass("checked")):(r.prop("checked",!0),i.addClass("checked")),r.change());return!1});r.closest("label").add('label[for="'+r.attr("id")+'"]').click(function(e){i.click();e.preventDefault()});r.on("change.styler",function(){r.is(":checked")?i.addClass("checked"):i.removeClass("checked")}).on("keydown.styler",function(e){32==e.which&&i.click()}).on("focus.styler",function(){i.is(".disabled")||i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")})};n();r.on("refresh",function(){r.off(".styler").parent().before(r).remove();n()})}});else if(r.is(":radio"))r.each(function(){if(1>r.parent("div.jq-radio").length){var i=function(){var i=new t,s=e("<div"+i.id+' class="jq-radio'+i.classes+'"'+i.title+'><div class="jq-radio__div"></div></div>');r.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(s).prependTo(s);s.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});r.is(":checked")&&s.addClass("checked");r.is(":disabled")&&s.addClass("disabled");s.on("click.styler",function(){s.is(".disabled")||(s.closest(n.wrapper).find('input[name="'+r.attr("name")+'"]').prop("checked",!1).parent().removeClass("checked"),r.prop("checked",!0).parent().addClass("checked"),r.change());return!1});r.closest("label").add('label[for="'+r.attr("id")+'"]').click(function(e){s.click();e.preventDefault()});r.on("change.styler",function(){r.parent().addClass("checked")}).on("focus.styler",function(){s.is(".disabled")||s.addClass("focused")}).on("blur.styler",function(){s.removeClass("focused")})};i();r.on("refresh",function(){r.off(".styler").parent().before(r).remove();i()})}});else if(r.is(":file"))r.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0}).each(function(){if(1>r.parent("div.jq-file").length){var i=function(){var i=new t,s=r.data("placeholder");void 0===s&&(s=n.filePlaceholder);var o=r.data("browse");if(void 0===o||""===o)o=n.fileBrowse;var u=e("<div"+i.id+' class="jq-file'+i.classes+'"'+i.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),a=e('<div class="jq-file__browse">'+o+"</div>").appendTo(u);e('<div class="jq-file__name">'+s+"</div>").appendTo(u);r.after(u);u.append(r);r.is(":disabled")&&u.addClass("disabled");r.on("change.styler",function(){var e=r.val();if(r.is("[multiple]"))for(var e="",t=r[0].files,n=0;n<t.length;n++)e+=(0<n?", ":"")+t[n].name;a.text(e.replace(/.+[\\\/]/,""));""===e?(a.text(s),u.removeClass("changed")):u.addClass("changed")}).on("focus.styler",function(){u.addClass("focused")}).on("blur.styler",function(){u.removeClass("focused")}).on("click.styler",function(){u.removeClass("focused")})};i();r.on("refresh",function(){r.off(".styler").parent().before(r).remove();i()})}});else if(r.is("select"))r.each(function(){if(1>r.parent("div.jqselect").length){var i=function(){function i(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var n=null;"mousewheel"==t.type?n=-1*t.originalEvent.wheelDelta:"DOMMouseScroll"==t.type&&(n=40*t.originalEvent.detail);n&&(t.stopPropagation(),t.preventDefault(),e(this).scrollTop(n+e(this).scrollTop()))})}function s(){for(var e=0,t=a.length;e<t;e++){var n="",r="",i=n="",s="",o="";a.eq(e).prop("selected")&&(r="selected sel");a.eq(e).is(":disabled")&&(r="disabled");a.eq(e).is(":selected:disabled")&&(r="selected sel disabled");void 0!==a.eq(e).attr("class")&&(i=" "+a.eq(e).attr("class"),o=' data-jqfs-class="'+a.eq(e).attr("class")+'"');var u=a.eq(e).data(),l;for(l in u)""!==u[l]&&(n+=" data-"+l+'="'+u[l]+'"');n="<li"+o+n+' class="'+r+i+'">'+a.eq(e).html()+"</li>";a.eq(e).parent().is("optgroup")&&(void 0!==a.eq(e).parent().attr("class")&&(s=" "+a.eq(e).parent().attr("class")),n="<li"+o+' class="'+r+i+" option"+s+'">'+a.eq(e).html()+"</li>",a.eq(e).is(":first-child")&&(n='<li class="optgroup'+s+'">'+a.eq(e).parent().attr("label")+"</li>"+n));f+=n}}function o(){var o=new t,u="",l=r.data("placeholder"),c=r.data("search"),h=r.data("search-limit"),p=r.data("search-not-found"),d=r.data("search-placeholder"),v=r.data("z-index"),m=r.data("smart-positioning");void 0===l&&(l=n.selectPlaceholder);if(void 0===c||""===c)c=n.selectSearch;if(void 0===h||""===h)h=n.selectSearchLimit;if(void 0===p||""===p)p=n.selectSearchNotFound;void 0===d&&(d=n.selectSearchPlaceholder);if(void 0===v||""===v)v=n.singleSelectzIndex;if(void 0===m||""===m)m=n.selectSmartPositioning;var g=e("<div"+o.id+' class="jq-selectbox jqselect'+o.classes+'" style="display: inline-block; position: relative; z-index:'+v+'"><div class="jq-selectbox__select"'+o.title+' style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');r.css({margin:0,padding:0}).after(g).prependTo(g);var y=e("div.jq-selectbox__select",g),b=e("div.jq-selectbox__select-text",g),o=a.filter(":selected");s();c&&(u='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+d+'"></div><div class="jq-selectbox__not-found">'+p+"</div>");var w=e('<div class="jq-selectbox__dropdown" style="position: absolute">'+u+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+f+"</ul></div>");g.append(w);var E=e("ul",w),S=e("li",w),x=e("input",w),T=e("div.jq-selectbox__not-found",w).hide();S.length<h&&x.parent().hide();var N=0,C=0;S.each(function(){var t=e(this);t.css({display:"inline-block","white-space":"nowrap"});t.innerWidth()>N&&(N=t.innerWidth(),C=t.width());t.css({display:"block"})});u=g.clone().appendTo("body").width("auto");c=u.width();u.remove();c==g.width()&&b.width(C);N>g.width()&&w.width(N);""===r.val()?b.text(l).addClass("placeholder"):b.text(o.text());""===a.first().text()&&""!==r.data("placeholder")&&S.first().hide();r.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var k=g.outerHeight(),L=x.outerHeight(),A=E.css("max-height"),l=S.filter(".selected");1>l.length&&S.first().addClass("selected sel");void 0===S.data("li-height")&&S.data("li-height",S.outerHeight());var O=w.css("top");"auto"==w.css("left")&&w.css({left:0});"auto"==w.css("top")&&w.css({top:k});w.hide();l.length&&(a.first().text()!=o.text()&&g.addClass("changed"),g.data("jqfs-class",l.data("jqfs-class")),g.addClass(l.data("jqfs-class")));if(r.is(":disabled"))return g.addClass("disabled"),!1;y.click(function(){e("div.jq-selectbox").filter(".opened").length&&n.onSelectClosed.call(e("div.jq-selectbox").filter(".opened"));r.focus();if(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)){var t=e(window),s=S.data("li-height"),o=g.offset().top,u=t.height()-k-(o-t.scrollTop()),f=r.data("visible-options");if(void 0===f||""===f)f=n.selectVisibleOptions;var l=5*s,c=s*f;0<f&&6>f&&(l=c);0===f&&(c="auto");var f=function(){w.height("auto").css({bottom:"auto",top:O});var e=function(){E.css("max-height",Math.floor((u-20-L)/s)*s)};e();E.css("max-height",c);"none"!=A&&E.css("max-height",A);u<w.outerHeight()+20&&e()},h=function(){w.height("auto").css({top:"auto",bottom:O});var e=function(){E.css("max-height",Math.floor((o-t.scrollTop()-20-L)/s)*s)};e();E.css("max-height",c);"none"!=A&&E.css("max-height",A);o-t.scrollTop()-20<w.outerHeight()+20&&e()};!0===m||1===m?u>l+L+20?(f(),g.removeClass("dropup").addClass("dropdown")):(h(),g.removeClass("dropdown").addClass("dropup")):(!1===m||0===m)&&u>l+L+20&&(f(),g.removeClass("dropup").addClass("dropdown"));e("div.jqselect").css({zIndex:v-1}).removeClass("opened");g.css({zIndex:v});w.is(":hidden")?(e("div.jq-selectbox__dropdown:visible").hide(),w.show(),g.addClass("opened focused"),n.onSelectOpened.call(g)):(w.hide(),g.removeClass("opened dropup dropdown"),e("div.jq-selectbox").filter(".opened").length&&n.onSelectClosed.call(g));x.length&&(x.val("").keyup(),T.hide(),x.keyup(function(){var t=e(this).val();S.each(function(){e(this).html().match(RegExp(".*?"+t+".*?","i"))?e(this).show():e(this).hide()});""===a.first().text()&&""!==r.data("placeholder")&&S.first().hide();1>S.filter(":visible").length?T.show():T.hide()}));S.filter(".selected").length&&(0!==E.innerHeight()/s%2&&(s/=2),E.scrollTop(E.scrollTop()+S.filter(".selected").position().top-E.innerHeight()/2+s));i(E);return!1}});S.hover(function(){e(this).siblings().removeClass("selected")});S.filter(".selected").text();S.filter(".selected").text();S.filter(":not(.disabled):not(.optgroup)").click(function(){r.focus();var t=e(this),i=t.text();if(!t.is(".selected")){var s=t.index(),s=s-t.prevAll(".optgroup").length;t.addClass("selected sel").siblings().removeClass("selected sel");a.prop("selected",!1).eq(s).prop("selected",!0);b.text(i);g.data("jqfs-class")&&g.removeClass(g.data("jqfs-class"));g.data("jqfs-class",t.data("jqfs-class"));g.addClass(t.data("jqfs-class"));r.change()}w.hide();g.removeClass("opened dropup dropdown");n.onSelectClosed.call(g)});w.mouseout(function(){e("li.sel",w).addClass("selected")});r.on("change.styler",function(){b.text(a.filter(":selected").text()).removeClass("placeholder");S.removeClass("selected sel").not(".optgroup").eq(r[0].selectedIndex).addClass("selected sel");a.first().text()!=S.filter(".selected").text()?g.addClass("changed"):g.removeClass("changed")}).on("focus.styler",function(){g.addClass("focused");e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur.styler",function(){g.removeClass("focused")}).on("keydown.styler keyup.styler",function(e){var t=S.data("li-height");b.text(a.filter(":selected").text());S.removeClass("selected sel").not(".optgroup").eq(r[0].selectedIndex).addClass("selected sel");38!=e.which&&37!=e.which&&33!=e.which&&36!=e.which||E.scrollTop(E.scrollTop()+S.filter(".selected").position().top);40!=e.which&&39!=e.which&&34!=e.which&&35!=e.which||E.scrollTop(E.scrollTop()+S.filter(".selected").position().top-E.innerHeight()+t);13==e.which&&(e.preventDefault(),w.hide(),g.removeClass("opened dropup dropdown"),n.onSelectClosed.call(g))}).on("keydown.styler",function(e){32==e.which&&(e.preventDefault(),y.click())});e(document).on("click",function(t){e(t.target).parents().hasClass("jq-selectbox")||"OPTION"==t.target.nodeName||(e("div.jq-selectbox").filter(".opened").length&&n.onSelectClosed.call(e("div.jq-selectbox").filter(".opened")),x.length&&x.val("").keyup(),w.hide().find("li.sel").addClass("selected"),g.removeClass("focused opened dropup dropdown"))})}function u(){var n=new t,o=e("<div"+n.id+' class="jq-select-multiple jqselect'+n.classes+'"'+n.title+' style="display: inline-block; position: relative"></div>');r.css({margin:0,padding:0}).after(o);s();o.append("<ul>"+f+"</ul>");var u=e("ul",o).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),l=e("li",o).attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none","white-space":"nowrap"}),n=r.attr("size"),c=u.outerHeight(),h=l.outerHeight();void 0!==n&&0<n?u.css({height:h*n}):u.css({height:4*h});c>o.height()&&(u.css("overflowY","scroll"),i(u),l.filter(".selected").length&&u.scrollTop(u.scrollTop()+l.filter(".selected").position().top));r.prependTo(o).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});if(r.is(":disabled"))o.addClass("disabled"),a.each(function(){e(this).is(":selected")&&l.eq(e(this).index()).addClass("selected")});else if(l.filter(":not(.disabled):not(.optgroup)").click(function(t){r.focus();var n=e(this);t.ctrlKey||t.metaKey||n.addClass("selected");t.shiftKey||n.addClass("first");t.ctrlKey||t.metaKey||t.shiftKey||n.siblings().removeClass("selected first");if(t.ctrlKey||t.metaKey)n.is(".selected")?n.removeClass("selected first"):n.addClass("selected first"),n.siblings().removeClass("first");if(t.shiftKey){var i=!1,s=!1;n.siblings().removeClass("selected").siblings(".first").addClass("selected");n.prevAll().each(function(){e(this).is(".first")&&(i=!0)});n.nextAll().each(function(){e(this).is(".first")&&(s=!0)});i&&n.prevAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")});s&&n.nextAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")});1==l.filter(".selected").length&&n.addClass("first")}a.prop("selected",!1);l.filter(".selected").each(function(){var t=e(this),n=t.index();t.is(".option")&&(n-=t.prevAll(".optgroup").length);a.eq(n).prop("selected",!0)});r.change()}),a.each(function(t){e(this).data("optionIndex",t)}),r.on("change.styler",function(){l.removeClass("selected");var t=[];a.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))});l.not(".optgroup").filter(function(n){return-1<e.inArray(n,t)}).addClass("selected")}).on("focus.styler",function(){o.addClass("focused")}).on("blur.styler",function(){o.removeClass("focused")}),c>o.height())r.on("keydown.styler",function(e){38!=e.which&&37!=e.which&&33!=e.which||u.scrollTop(u.scrollTop()+l.filter(".selected").position().top-h);40!=e.which&&39!=e.which&&34!=e.which||u.scrollTop(u.scrollTop()+l.filter(".selected:last").position().top-u.innerHeight()+2*h)})}var a=e("option",r),f="";if(r.is("[multiple]")){var l=navigator.userAgent.match(/Android/i)?!0:!1,c=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)?!0:!1;l||c||u()}else o()};i();r.on("refresh",function(){r.off(".styler").parent().before(r).remove();i()})}});else if(r.is(":reset"))r.on("click",function(){setTimeout(function(){r.closest(n.wrapper).find("input, select").trigger("refresh")},1)})}).promise().done(function(){n.onFormStyled.call()})}})(jQuery)